
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Evaluating MAGIC with Synthetic Dataset &#8212; Academic Posts</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Markdown Files" href="markdown.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Academic Posts</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the site!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Evaluating MAGIC with Synthetic Dataset
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/saulvegasauceda/blog/main?urlpath=tree/docs/notebooks.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/saulvegasauceda/blog"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/saulvegasauceda/blog/issues/new?title=Issue%20on%20page%20%2Fnotebooks.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/notebooks.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/notebooks.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generating-synthetic-dataset">
   1. Generating Synthetic Dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intro-to-merfish-10x-scrna-seq">
     1.1: Intro to MERFISH &amp; 10x scRNA-seq
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-synthetic-cells-and-simulating-both-merfish-10x-scrna-seq">
     1.2: Generating synthetic cells and simulating both MERFISH &amp; 10x scRNA-seq
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data">
     1.3: Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#peeking-at-the-data">
       Peeking at the data:
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#synthetic-data">
         Synthetic Data:
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#merfish-data">
         MERFISH data:
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#x-scrna-seq-data">
         10x scRNA-seq data:
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-data">
       Plotting data:
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imputation">
   2. Imputation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#normalization">
     2.1: Normalization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#running-magic">
     2.2: Running MAGIC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rescaling-imputed-counts">
     2.3: Rescaling Imputed Counts
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results-after-imputation">
   3. Results after Imputation
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Evaluating MAGIC with Synthetic Dataset</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generating-synthetic-dataset">
   1. Generating Synthetic Dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intro-to-merfish-10x-scrna-seq">
     1.1: Intro to MERFISH &amp; 10x scRNA-seq
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-synthetic-cells-and-simulating-both-merfish-10x-scrna-seq">
     1.2: Generating synthetic cells and simulating both MERFISH &amp; 10x scRNA-seq
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data">
     1.3: Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#peeking-at-the-data">
       Peeking at the data:
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#synthetic-data">
         Synthetic Data:
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#merfish-data">
         MERFISH data:
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#x-scrna-seq-data">
         10x scRNA-seq data:
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-data">
       Plotting data:
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imputation">
   2. Imputation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#normalization">
     2.1: Normalization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#running-magic">
     2.2: Running MAGIC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rescaling-imputed-counts">
     2.3: Rescaling Imputed Counts
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results-after-imputation">
   3. Results after Imputation
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="evaluating-magic-with-synthetic-dataset">
<h1>Evaluating MAGIC with Synthetic Dataset<a class="headerlink" href="#evaluating-magic-with-synthetic-dataset" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="https://github.com/KrishnaswamyLab/MAGIC">MAGIC</a> is an imputation tool developed at the <a class="reference external" href="https://www.broadinstitute.org">Broad Institute</a> for single cell RNA-sequencing (scNRA-seq) data. Imputation can potentially help improve downstream analysis in scRNA-seq data pipelines due to the potential of denoising the high dropout rates (errerroneously observed 0s) that currently obscure gene-gene relationships. Despite this promise, MAGIC has failed to receive universal support on whether it successfully recuperates lost information. This is an attempt to discover the effects of MAGIC on a synthetic dataset to determine whether its claims holds true for a simple test case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#imports</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">magic</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">scanpy</span> <span class="k">as</span> <span class="nn">sc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scanpy.external</span> <span class="k">as</span> <span class="nn">sce</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">seed</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">normal</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choices</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">rv_discrete</span><span class="p">,</span> <span class="n">rv_continuous</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">nbinom</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#functions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seed</span><span class="p">(</span><span class="mi">1738</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_synthetic_cells</span><span class="p">(</span><span class="n">rna_species_char</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">number_cells</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Inputs</span>
<span class="sd">    --------</span>
<span class="sd">    p: the probability of a single success (parameter to scipy.stats.nbinom)</span>
<span class="sd">    rna_species_char: List of size N representing the profile of N RNA species</span>
<span class="sd">    number_cells: number of cells (rows) in synthetic dataset</span>
<span class="sd">    </span>
<span class="sd">    Sampling using a negative binomial distribution where n = # of median RNA</span>
<span class="sd">    </span>
<span class="sd">    Outputs</span>
<span class="sd">    --------</span>
<span class="sd">    Pandas dataframe of size (number_cells x N) where each row represents a cell</span>
<span class="sd">    sampled from rna_species_char.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">cell_generator</span> <span class="o">=</span> <span class="p">[</span><span class="n">nbinom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">rna_species_char</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">number_cells</span><span class="p">)</span> <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">cell_generator</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_axis</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;Gene </span><span class="si">{</span><span class="n">g</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">sim_capture</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">choices</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">artificially_sample_cells</span><span class="p">(</span><span class="n">true_cells_df</span><span class="p">,</span> <span class="n">capture_rate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Simulating Bernoulli sampling with synthetic dataset </span>
<span class="sd">    where p = capture_rate (p := probability RNA is included in set)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">true_cells_df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sim_capture</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">capture_rate</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">ready_for_plot</span><span class="p">():</span>
    <span class="n">merfish_repr</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MERFISH&quot;</span>
    <span class="n">tenx_repr</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;10X synthetic&quot;</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">merfish_repr</span><span class="p">,</span> <span class="n">tenx_repr</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">rescale_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target_data</span><span class="p">,</span> <span class="n">rescale</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function from older version of MAGIC to rescale after imputation</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">rescale</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">M99</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">target_data</span><span class="p">,</span> <span class="n">rescale</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">M100</span> <span class="o">=</span> <span class="n">target_data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">M99</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">M99</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">M100</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">M99_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rescale</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">M100_new</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">M99_new</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">M99_new</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">M100_new</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">max_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">M99</span><span class="p">,</span> <span class="n">M99_new</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">max_ratio</span><span class="p">,</span>
                                      <span class="p">(</span><span class="n">target_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<section id="generating-synthetic-dataset">
<h2>1. Generating Synthetic Dataset<a class="headerlink" href="#generating-synthetic-dataset" title="Permalink to this headline">#</a></h2>
<section id="intro-to-merfish-10x-scrna-seq">
<h3>1.1: Intro to MERFISH &amp; 10x scRNA-seq<a class="headerlink" href="#intro-to-merfish-10x-scrna-seq" title="Permalink to this headline">#</a></h3>
<p>Two popular methods for measuring RNA species post-mortem are: <a class="reference external" href="https://www.science.org/doi/10.1126/science.aaa6090">MERFISH</a> &amp; <a class="reference external" href="https://www.10xgenomics.com/blog/single-cell-rna-seq-an-introductory-overview-and-tools-for-getting-started">10x scRNA-seq</a>. Both these methods are able to identify which cells within a tissue sample a given mRNA molecule comes from. Besides MERFISH being a fluorescent approach and 10x scRNA-seq utilizes sequencing, they differ in their capture rates and number of observed RNA species. MERFISH is limited by the visual spectrum, thus, can only observe an order of ~100 RNA species but with a capture rate of ~90% (fraction of RNA transcripts observerd within the ~100 RNA species). Meanwhile, 10x scRNA-seq is not bound by the observed RNA species but observe mRNA with a <a class="reference external" href="https://kb.10xgenomics.com/hc/en-us/articles/360001539051-What-fraction-of-mRNA-transcripts-are-captured-per-cell-">much lower capture rate of 30-32%</a>.</p>
</section>
<section id="generating-synthetic-cells-and-simulating-both-merfish-10x-scrna-seq">
<h3>1.2: Generating synthetic cells and simulating both MERFISH &amp; 10x scRNA-seq<a class="headerlink" href="#generating-synthetic-cells-and-simulating-both-merfish-10x-scrna-seq" title="Permalink to this headline">#</a></h3>
<p>Sampling using a negative binomial distribution for the cells we will determine as the ground truth. Then, simulating both MERFISH &amp; 10x scRNA-seq as a Bernoulli process with the capture rate serving as the probability of a success.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Rna_species_characteristic_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">]</span>

<span class="n">synth_cells</span> <span class="o">=</span> <span class="n">create_synthetic_cells</span><span class="p">(</span><span class="n">Rna_species_characteristic_numbers</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">merfish_original_synth</span> <span class="o">=</span> <span class="n">artificially_sample_cells</span><span class="p">(</span><span class="n">synth_cells</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
<span class="n">tenx_original_synth</span> <span class="o">=</span> <span class="n">artificially_sample_cells</span><span class="p">(</span><span class="n">synth_cells</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>

<span class="n">synth_cells</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Ground Truth&quot;</span>
<span class="n">merfish_original_synth</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MERFISH&quot;</span>
<span class="n">tenx_original_synth</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;10x scRNA-seq&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="data">
<h3>1.3: Data<a class="headerlink" href="#data" title="Permalink to this headline">#</a></h3>
<section id="peeking-at-the-data">
<h4>Peeking at the data:<a class="headerlink" href="#peeking-at-the-data" title="Permalink to this headline">#</a></h4>
<section id="synthetic-data">
<h5>Synthetic Data:<a class="headerlink" href="#synthetic-data" title="Permalink to this headline">#</a></h5>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">synth_cells</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gene 1</th>
      <th>Gene 2</th>
      <th>Gene 3</th>
      <th>Gene 4</th>
      <th>Gene 5</th>
      <th>Gene 6</th>
      <th>Gene 7</th>
      <th>Gene 8</th>
      <th>Gene 9</th>
      <th>Model</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
      <td>8</td>
      <td>30</td>
      <td>121</td>
      <td>295</td>
      <td>940</td>
      <td>2987</td>
      <td>10138</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>3</td>
      <td>5</td>
      <td>21</td>
      <td>116</td>
      <td>296</td>
      <td>1002</td>
      <td>2970</td>
      <td>10366</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>1</td>
      <td>17</td>
      <td>18</td>
      <td>133</td>
      <td>320</td>
      <td>1031</td>
      <td>3073</td>
      <td>9983</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>29</td>
      <td>118</td>
      <td>320</td>
      <td>983</td>
      <td>2861</td>
      <td>9927</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>2</td>
      <td>8</td>
      <td>30</td>
      <td>85</td>
      <td>290</td>
      <td>1056</td>
      <td>2982</td>
      <td>9959</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>3</td>
      <td>16</td>
      <td>37</td>
      <td>104</td>
      <td>309</td>
      <td>997</td>
      <td>2895</td>
      <td>10034</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>33</td>
      <td>78</td>
      <td>330</td>
      <td>1068</td>
      <td>3098</td>
      <td>10097</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>5</td>
      <td>8</td>
      <td>25</td>
      <td>102</td>
      <td>322</td>
      <td>1050</td>
      <td>3028</td>
      <td>9973</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>30</td>
      <td>99</td>
      <td>319</td>
      <td>1038</td>
      <td>2956</td>
      <td>9895</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>2</td>
      <td>13</td>
      <td>24</td>
      <td>127</td>
      <td>303</td>
      <td>1040</td>
      <td>2914</td>
      <td>9986</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>26</td>
      <td>76</td>
      <td>294</td>
      <td>985</td>
      <td>2879</td>
      <td>9822</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>8</td>
      <td>9</td>
      <td>34</td>
      <td>91</td>
      <td>336</td>
      <td>957</td>
      <td>3065</td>
      <td>10027</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>21</td>
      <td>93</td>
      <td>278</td>
      <td>1094</td>
      <td>3093</td>
      <td>10070</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>42</td>
      <td>94</td>
      <td>259</td>
      <td>977</td>
      <td>3002</td>
      <td>10064</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2</td>
      <td>0</td>
      <td>15</td>
      <td>27</td>
      <td>128</td>
      <td>287</td>
      <td>1044</td>
      <td>2994</td>
      <td>10050</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0</td>
      <td>2</td>
      <td>11</td>
      <td>23</td>
      <td>110</td>
      <td>313</td>
      <td>998</td>
      <td>3141</td>
      <td>10163</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>26</td>
      <td>116</td>
      <td>288</td>
      <td>1024</td>
      <td>2979</td>
      <td>10040</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1</td>
      <td>7</td>
      <td>14</td>
      <td>31</td>
      <td>88</td>
      <td>349</td>
      <td>998</td>
      <td>3057</td>
      <td>9951</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0</td>
      <td>10</td>
      <td>19</td>
      <td>31</td>
      <td>106</td>
      <td>284</td>
      <td>995</td>
      <td>3041</td>
      <td>9856</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
      <td>3</td>
      <td>14</td>
      <td>19</td>
      <td>112</td>
      <td>308</td>
      <td>990</td>
      <td>3056</td>
      <td>9998</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1</td>
      <td>3</td>
      <td>12</td>
      <td>24</td>
      <td>99</td>
      <td>301</td>
      <td>1021</td>
      <td>3127</td>
      <td>9926</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>47</td>
      <td>91</td>
      <td>306</td>
      <td>1082</td>
      <td>2963</td>
      <td>9865</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0</td>
      <td>2</td>
      <td>14</td>
      <td>35</td>
      <td>81</td>
      <td>361</td>
      <td>992</td>
      <td>2938</td>
      <td>10014</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1</td>
      <td>0</td>
      <td>13</td>
      <td>17</td>
      <td>103</td>
      <td>325</td>
      <td>934</td>
      <td>2942</td>
      <td>10048</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2</td>
      <td>0</td>
      <td>9</td>
      <td>14</td>
      <td>106</td>
      <td>326</td>
      <td>1028</td>
      <td>3015</td>
      <td>10216</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>28</td>
      <td>76</td>
      <td>351</td>
      <td>961</td>
      <td>2996</td>
      <td>10090</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0</td>
      <td>3</td>
      <td>10</td>
      <td>38</td>
      <td>102</td>
      <td>302</td>
      <td>1025</td>
      <td>3018</td>
      <td>9945</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>29</td>
      <td>107</td>
      <td>344</td>
      <td>950</td>
      <td>2882</td>
      <td>9869</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>38</td>
      <td>100</td>
      <td>305</td>
      <td>1009</td>
      <td>2839</td>
      <td>10087</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2</td>
      <td>1</td>
      <td>8</td>
      <td>16</td>
      <td>87</td>
      <td>284</td>
      <td>990</td>
      <td>2970</td>
      <td>10063</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2</td>
      <td>1</td>
      <td>9</td>
      <td>31</td>
      <td>78</td>
      <td>291</td>
      <td>1005</td>
      <td>3172</td>
      <td>9906</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1</td>
      <td>2</td>
      <td>9</td>
      <td>22</td>
      <td>98</td>
      <td>275</td>
      <td>983</td>
      <td>2967</td>
      <td>10142</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0</td>
      <td>0</td>
      <td>21</td>
      <td>26</td>
      <td>102</td>
      <td>286</td>
      <td>997</td>
      <td>3088</td>
      <td>10046</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0</td>
      <td>4</td>
      <td>8</td>
      <td>15</td>
      <td>108</td>
      <td>303</td>
      <td>928</td>
      <td>2973</td>
      <td>9820</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>34</th>
      <td>0</td>
      <td>2</td>
      <td>10</td>
      <td>17</td>
      <td>97</td>
      <td>296</td>
      <td>1003</td>
      <td>3065</td>
      <td>10097</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2</td>
      <td>1</td>
      <td>19</td>
      <td>23</td>
      <td>110</td>
      <td>318</td>
      <td>916</td>
      <td>2886</td>
      <td>10109</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>36</th>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>30</td>
      <td>100</td>
      <td>289</td>
      <td>970</td>
      <td>2970</td>
      <td>10119</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>37</th>
      <td>1</td>
      <td>5</td>
      <td>11</td>
      <td>37</td>
      <td>86</td>
      <td>294</td>
      <td>969</td>
      <td>2791</td>
      <td>9830</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>38</th>
      <td>0</td>
      <td>1</td>
      <td>7</td>
      <td>24</td>
      <td>87</td>
      <td>295</td>
      <td>1045</td>
      <td>2970</td>
      <td>9946</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>39</th>
      <td>1</td>
      <td>1</td>
      <td>14</td>
      <td>38</td>
      <td>108</td>
      <td>264</td>
      <td>1046</td>
      <td>3041</td>
      <td>9797</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1</td>
      <td>3</td>
      <td>10</td>
      <td>23</td>
      <td>103</td>
      <td>266</td>
      <td>986</td>
      <td>2987</td>
      <td>9774</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>41</th>
      <td>0</td>
      <td>5</td>
      <td>18</td>
      <td>26</td>
      <td>120</td>
      <td>310</td>
      <td>1048</td>
      <td>2912</td>
      <td>9875</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0</td>
      <td>1</td>
      <td>12</td>
      <td>21</td>
      <td>97</td>
      <td>287</td>
      <td>990</td>
      <td>3076</td>
      <td>10072</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>43</th>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>35</td>
      <td>118</td>
      <td>336</td>
      <td>1012</td>
      <td>3087</td>
      <td>10177</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>44</th>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>39</td>
      <td>109</td>
      <td>283</td>
      <td>1070</td>
      <td>3032</td>
      <td>10111</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>45</th>
      <td>0</td>
      <td>0</td>
      <td>11</td>
      <td>24</td>
      <td>108</td>
      <td>319</td>
      <td>970</td>
      <td>2904</td>
      <td>9809</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>46</th>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>31</td>
      <td>104</td>
      <td>247</td>
      <td>1048</td>
      <td>2943</td>
      <td>9878</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>47</th>
      <td>3</td>
      <td>1</td>
      <td>7</td>
      <td>34</td>
      <td>100</td>
      <td>296</td>
      <td>1022</td>
      <td>2931</td>
      <td>9842</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>48</th>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>18</td>
      <td>123</td>
      <td>325</td>
      <td>994</td>
      <td>2918</td>
      <td>9990</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1</td>
      <td>7</td>
      <td>6</td>
      <td>29</td>
      <td>92</td>
      <td>265</td>
      <td>1005</td>
      <td>2903</td>
      <td>9876</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>50</th>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>31</td>
      <td>108</td>
      <td>299</td>
      <td>1091</td>
      <td>2858</td>
      <td>10115</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>51</th>
      <td>3</td>
      <td>8</td>
      <td>5</td>
      <td>26</td>
      <td>98</td>
      <td>301</td>
      <td>954</td>
      <td>3046</td>
      <td>9785</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>52</th>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>23</td>
      <td>91</td>
      <td>278</td>
      <td>1037</td>
      <td>2980</td>
      <td>9824</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>53</th>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>33</td>
      <td>117</td>
      <td>306</td>
      <td>1000</td>
      <td>3004</td>
      <td>10031</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>54</th>
      <td>5</td>
      <td>9</td>
      <td>12</td>
      <td>36</td>
      <td>92</td>
      <td>333</td>
      <td>897</td>
      <td>2964</td>
      <td>9859</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>55</th>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>36</td>
      <td>106</td>
      <td>360</td>
      <td>896</td>
      <td>3009</td>
      <td>9996</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>56</th>
      <td>1</td>
      <td>2</td>
      <td>10</td>
      <td>28</td>
      <td>123</td>
      <td>279</td>
      <td>1032</td>
      <td>2942</td>
      <td>9999</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>57</th>
      <td>0</td>
      <td>3</td>
      <td>11</td>
      <td>20</td>
      <td>100</td>
      <td>297</td>
      <td>974</td>
      <td>3054</td>
      <td>10034</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>58</th>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>29</td>
      <td>85</td>
      <td>283</td>
      <td>997</td>
      <td>2920</td>
      <td>9932</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>59</th>
      <td>0</td>
      <td>4</td>
      <td>11</td>
      <td>29</td>
      <td>115</td>
      <td>349</td>
      <td>999</td>
      <td>3089</td>
      <td>9800</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>60</th>
      <td>1</td>
      <td>0</td>
      <td>14</td>
      <td>28</td>
      <td>90</td>
      <td>295</td>
      <td>971</td>
      <td>3034</td>
      <td>9733</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>61</th>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>26</td>
      <td>117</td>
      <td>275</td>
      <td>1008</td>
      <td>2896</td>
      <td>10124</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>62</th>
      <td>0</td>
      <td>6</td>
      <td>14</td>
      <td>28</td>
      <td>88</td>
      <td>310</td>
      <td>1000</td>
      <td>3007</td>
      <td>9950</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>63</th>
      <td>1</td>
      <td>4</td>
      <td>8</td>
      <td>24</td>
      <td>117</td>
      <td>323</td>
      <td>1018</td>
      <td>2993</td>
      <td>10165</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>64</th>
      <td>0</td>
      <td>3</td>
      <td>5</td>
      <td>23</td>
      <td>119</td>
      <td>277</td>
      <td>1043</td>
      <td>3051</td>
      <td>10018</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>65</th>
      <td>0</td>
      <td>0</td>
      <td>11</td>
      <td>31</td>
      <td>103</td>
      <td>289</td>
      <td>1053</td>
      <td>3049</td>
      <td>10069</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>66</th>
      <td>1</td>
      <td>2</td>
      <td>11</td>
      <td>29</td>
      <td>92</td>
      <td>274</td>
      <td>1049</td>
      <td>2940</td>
      <td>9848</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>67</th>
      <td>0</td>
      <td>0</td>
      <td>19</td>
      <td>29</td>
      <td>92</td>
      <td>275</td>
      <td>1045</td>
      <td>3044</td>
      <td>9764</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>68</th>
      <td>0</td>
      <td>2</td>
      <td>13</td>
      <td>40</td>
      <td>98</td>
      <td>293</td>
      <td>996</td>
      <td>3045</td>
      <td>10013</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>69</th>
      <td>1</td>
      <td>7</td>
      <td>7</td>
      <td>24</td>
      <td>119</td>
      <td>317</td>
      <td>1035</td>
      <td>3084</td>
      <td>10241</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>70</th>
      <td>0</td>
      <td>0</td>
      <td>19</td>
      <td>34</td>
      <td>105</td>
      <td>275</td>
      <td>941</td>
      <td>2949</td>
      <td>9855</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>71</th>
      <td>1</td>
      <td>5</td>
      <td>12</td>
      <td>15</td>
      <td>111</td>
      <td>313</td>
      <td>1000</td>
      <td>2904</td>
      <td>10067</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>72</th>
      <td>0</td>
      <td>3</td>
      <td>11</td>
      <td>30</td>
      <td>97</td>
      <td>260</td>
      <td>1098</td>
      <td>3065</td>
      <td>10249</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>73</th>
      <td>1</td>
      <td>2</td>
      <td>6</td>
      <td>37</td>
      <td>73</td>
      <td>305</td>
      <td>1076</td>
      <td>2997</td>
      <td>9920</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>74</th>
      <td>2</td>
      <td>0</td>
      <td>10</td>
      <td>38</td>
      <td>90</td>
      <td>286</td>
      <td>966</td>
      <td>2939</td>
      <td>9860</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>75</th>
      <td>0</td>
      <td>5</td>
      <td>12</td>
      <td>33</td>
      <td>85</td>
      <td>328</td>
      <td>1019</td>
      <td>3031</td>
      <td>10069</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>76</th>
      <td>2</td>
      <td>4</td>
      <td>10</td>
      <td>24</td>
      <td>101</td>
      <td>293</td>
      <td>941</td>
      <td>3004</td>
      <td>10110</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>77</th>
      <td>0</td>
      <td>1</td>
      <td>15</td>
      <td>19</td>
      <td>105</td>
      <td>316</td>
      <td>1014</td>
      <td>3145</td>
      <td>10064</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>78</th>
      <td>1</td>
      <td>8</td>
      <td>15</td>
      <td>32</td>
      <td>90</td>
      <td>299</td>
      <td>1073</td>
      <td>2915</td>
      <td>10063</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>79</th>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>27</td>
      <td>113</td>
      <td>300</td>
      <td>1018</td>
      <td>3106</td>
      <td>10189</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>80</th>
      <td>1</td>
      <td>1</td>
      <td>13</td>
      <td>36</td>
      <td>120</td>
      <td>281</td>
      <td>988</td>
      <td>3019</td>
      <td>10274</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>81</th>
      <td>0</td>
      <td>8</td>
      <td>16</td>
      <td>29</td>
      <td>94</td>
      <td>287</td>
      <td>987</td>
      <td>3121</td>
      <td>9946</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>82</th>
      <td>1</td>
      <td>3</td>
      <td>8</td>
      <td>30</td>
      <td>88</td>
      <td>310</td>
      <td>975</td>
      <td>3105</td>
      <td>9900</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>83</th>
      <td>0</td>
      <td>4</td>
      <td>11</td>
      <td>29</td>
      <td>125</td>
      <td>307</td>
      <td>1014</td>
      <td>3064</td>
      <td>10343</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>84</th>
      <td>2</td>
      <td>2</td>
      <td>9</td>
      <td>35</td>
      <td>96</td>
      <td>281</td>
      <td>960</td>
      <td>3073</td>
      <td>9995</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>85</th>
      <td>0</td>
      <td>2</td>
      <td>11</td>
      <td>31</td>
      <td>116</td>
      <td>283</td>
      <td>946</td>
      <td>2869</td>
      <td>10080</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>86</th>
      <td>1</td>
      <td>1</td>
      <td>7</td>
      <td>33</td>
      <td>107</td>
      <td>305</td>
      <td>907</td>
      <td>3053</td>
      <td>10090</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>87</th>
      <td>1</td>
      <td>8</td>
      <td>7</td>
      <td>28</td>
      <td>108</td>
      <td>249</td>
      <td>968</td>
      <td>3032</td>
      <td>9880</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>88</th>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>35</td>
      <td>82</td>
      <td>276</td>
      <td>1023</td>
      <td>3006</td>
      <td>9898</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>89</th>
      <td>5</td>
      <td>1</td>
      <td>11</td>
      <td>24</td>
      <td>66</td>
      <td>301</td>
      <td>1061</td>
      <td>3005</td>
      <td>9751</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>90</th>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>14</td>
      <td>96</td>
      <td>290</td>
      <td>1031</td>
      <td>2957</td>
      <td>10057</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>91</th>
      <td>1</td>
      <td>1</td>
      <td>17</td>
      <td>18</td>
      <td>92</td>
      <td>299</td>
      <td>1005</td>
      <td>3178</td>
      <td>9961</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>92</th>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>30</td>
      <td>109</td>
      <td>267</td>
      <td>977</td>
      <td>2885</td>
      <td>9900</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>93</th>
      <td>1</td>
      <td>1</td>
      <td>9</td>
      <td>27</td>
      <td>125</td>
      <td>289</td>
      <td>1013</td>
      <td>2965</td>
      <td>10019</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>94</th>
      <td>1</td>
      <td>1</td>
      <td>11</td>
      <td>31</td>
      <td>84</td>
      <td>313</td>
      <td>1008</td>
      <td>3057</td>
      <td>9991</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>95</th>
      <td>2</td>
      <td>2</td>
      <td>10</td>
      <td>34</td>
      <td>117</td>
      <td>283</td>
      <td>1018</td>
      <td>2972</td>
      <td>9916</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>96</th>
      <td>0</td>
      <td>1</td>
      <td>9</td>
      <td>25</td>
      <td>89</td>
      <td>322</td>
      <td>974</td>
      <td>2966</td>
      <td>10133</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>97</th>
      <td>2</td>
      <td>1</td>
      <td>12</td>
      <td>21</td>
      <td>100</td>
      <td>282</td>
      <td>1046</td>
      <td>2975</td>
      <td>9901</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>98</th>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>31</td>
      <td>81</td>
      <td>301</td>
      <td>974</td>
      <td>3068</td>
      <td>9892</td>
      <td>Ground Truth</td>
    </tr>
    <tr>
      <th>99</th>
      <td>0</td>
      <td>12</td>
      <td>6</td>
      <td>25</td>
      <td>106</td>
      <td>279</td>
      <td>1017</td>
      <td>3042</td>
      <td>9856</td>
      <td>Ground Truth</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="merfish-data">
<h5>MERFISH data:<a class="headerlink" href="#merfish-data" title="Permalink to this headline">#</a></h5>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merfish_original_synth</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gene 1</th>
      <th>Gene 2</th>
      <th>Gene 3</th>
      <th>Gene 4</th>
      <th>Gene 5</th>
      <th>Gene 6</th>
      <th>Gene 7</th>
      <th>Gene 8</th>
      <th>Gene 9</th>
      <th>Model</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
      <td>7</td>
      <td>29</td>
      <td>113</td>
      <td>258</td>
      <td>869</td>
      <td>2697</td>
      <td>9117</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>16</td>
      <td>103</td>
      <td>265</td>
      <td>896</td>
      <td>2678</td>
      <td>9314</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>1</td>
      <td>17</td>
      <td>17</td>
      <td>125</td>
      <td>281</td>
      <td>921</td>
      <td>2754</td>
      <td>8989</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>26</td>
      <td>111</td>
      <td>293</td>
      <td>902</td>
      <td>2577</td>
      <td>8916</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>2</td>
      <td>8</td>
      <td>26</td>
      <td>78</td>
      <td>268</td>
      <td>936</td>
      <td>2682</td>
      <td>8959</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>3</td>
      <td>12</td>
      <td>32</td>
      <td>95</td>
      <td>276</td>
      <td>899</td>
      <td>2604</td>
      <td>9021</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>28</td>
      <td>68</td>
      <td>305</td>
      <td>956</td>
      <td>2767</td>
      <td>9060</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>4</td>
      <td>8</td>
      <td>25</td>
      <td>92</td>
      <td>298</td>
      <td>930</td>
      <td>2708</td>
      <td>8921</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>26</td>
      <td>88</td>
      <td>292</td>
      <td>942</td>
      <td>2653</td>
      <td>8935</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>2</td>
      <td>10</td>
      <td>21</td>
      <td>117</td>
      <td>272</td>
      <td>939</td>
      <td>2623</td>
      <td>8960</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>24</td>
      <td>68</td>
      <td>261</td>
      <td>883</td>
      <td>2581</td>
      <td>8842</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>7</td>
      <td>9</td>
      <td>31</td>
      <td>85</td>
      <td>298</td>
      <td>853</td>
      <td>2750</td>
      <td>9071</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>20</td>
      <td>77</td>
      <td>256</td>
      <td>991</td>
      <td>2791</td>
      <td>9033</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>37</td>
      <td>82</td>
      <td>244</td>
      <td>890</td>
      <td>2686</td>
      <td>9085</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2</td>
      <td>0</td>
      <td>12</td>
      <td>24</td>
      <td>116</td>
      <td>255</td>
      <td>944</td>
      <td>2671</td>
      <td>9096</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0</td>
      <td>2</td>
      <td>9</td>
      <td>22</td>
      <td>102</td>
      <td>279</td>
      <td>901</td>
      <td>2822</td>
      <td>9162</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>24</td>
      <td>98</td>
      <td>270</td>
      <td>921</td>
      <td>2682</td>
      <td>9033</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1</td>
      <td>6</td>
      <td>14</td>
      <td>28</td>
      <td>82</td>
      <td>316</td>
      <td>893</td>
      <td>2741</td>
      <td>8989</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0</td>
      <td>7</td>
      <td>17</td>
      <td>24</td>
      <td>94</td>
      <td>257</td>
      <td>904</td>
      <td>2754</td>
      <td>8882</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
      <td>3</td>
      <td>12</td>
      <td>18</td>
      <td>98</td>
      <td>280</td>
      <td>886</td>
      <td>2783</td>
      <td>8983</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1</td>
      <td>3</td>
      <td>9</td>
      <td>24</td>
      <td>90</td>
      <td>269</td>
      <td>906</td>
      <td>2821</td>
      <td>8907</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>41</td>
      <td>87</td>
      <td>280</td>
      <td>986</td>
      <td>2664</td>
      <td>8882</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0</td>
      <td>1</td>
      <td>13</td>
      <td>33</td>
      <td>74</td>
      <td>324</td>
      <td>871</td>
      <td>2644</td>
      <td>9007</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1</td>
      <td>0</td>
      <td>10</td>
      <td>14</td>
      <td>93</td>
      <td>290</td>
      <td>840</td>
      <td>2642</td>
      <td>9060</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2</td>
      <td>0</td>
      <td>8</td>
      <td>12</td>
      <td>93</td>
      <td>290</td>
      <td>930</td>
      <td>2692</td>
      <td>9215</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>25</td>
      <td>70</td>
      <td>316</td>
      <td>885</td>
      <td>2685</td>
      <td>9074</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0</td>
      <td>2</td>
      <td>10</td>
      <td>38</td>
      <td>91</td>
      <td>277</td>
      <td>901</td>
      <td>2699</td>
      <td>8909</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>26</td>
      <td>99</td>
      <td>306</td>
      <td>842</td>
      <td>2588</td>
      <td>8861</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>35</td>
      <td>90</td>
      <td>276</td>
      <td>908</td>
      <td>2532</td>
      <td>9047</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2</td>
      <td>1</td>
      <td>7</td>
      <td>16</td>
      <td>73</td>
      <td>261</td>
      <td>902</td>
      <td>2694</td>
      <td>9075</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2</td>
      <td>1</td>
      <td>8</td>
      <td>29</td>
      <td>71</td>
      <td>267</td>
      <td>902</td>
      <td>2839</td>
      <td>8891</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>20</td>
      <td>89</td>
      <td>251</td>
      <td>868</td>
      <td>2680</td>
      <td>9142</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0</td>
      <td>0</td>
      <td>20</td>
      <td>26</td>
      <td>91</td>
      <td>251</td>
      <td>877</td>
      <td>2778</td>
      <td>9077</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>14</td>
      <td>97</td>
      <td>264</td>
      <td>822</td>
      <td>2693</td>
      <td>8845</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>34</th>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>17</td>
      <td>85</td>
      <td>267</td>
      <td>903</td>
      <td>2752</td>
      <td>9067</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2</td>
      <td>1</td>
      <td>16</td>
      <td>23</td>
      <td>96</td>
      <td>287</td>
      <td>826</td>
      <td>2608</td>
      <td>9117</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>36</th>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>29</td>
      <td>91</td>
      <td>262</td>
      <td>867</td>
      <td>2672</td>
      <td>9122</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>37</th>
      <td>1</td>
      <td>3</td>
      <td>9</td>
      <td>35</td>
      <td>79</td>
      <td>266</td>
      <td>872</td>
      <td>2519</td>
      <td>8841</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>38</th>
      <td>0</td>
      <td>1</td>
      <td>7</td>
      <td>23</td>
      <td>82</td>
      <td>270</td>
      <td>930</td>
      <td>2683</td>
      <td>8970</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>39</th>
      <td>1</td>
      <td>1</td>
      <td>13</td>
      <td>34</td>
      <td>103</td>
      <td>243</td>
      <td>930</td>
      <td>2739</td>
      <td>8827</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>40</th>
      <td>1</td>
      <td>3</td>
      <td>8</td>
      <td>22</td>
      <td>96</td>
      <td>234</td>
      <td>887</td>
      <td>2675</td>
      <td>8786</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>41</th>
      <td>0</td>
      <td>5</td>
      <td>12</td>
      <td>24</td>
      <td>105</td>
      <td>282</td>
      <td>951</td>
      <td>2641</td>
      <td>8950</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>19</td>
      <td>88</td>
      <td>258</td>
      <td>892</td>
      <td>2800</td>
      <td>9115</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>43</th>
      <td>0</td>
      <td>1</td>
      <td>7</td>
      <td>32</td>
      <td>101</td>
      <td>302</td>
      <td>905</td>
      <td>2757</td>
      <td>9157</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>44</th>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>35</td>
      <td>99</td>
      <td>248</td>
      <td>978</td>
      <td>2729</td>
      <td>9093</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>45</th>
      <td>0</td>
      <td>0</td>
      <td>10</td>
      <td>22</td>
      <td>100</td>
      <td>279</td>
      <td>870</td>
      <td>2610</td>
      <td>8823</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>46</th>
      <td>0</td>
      <td>1</td>
      <td>7</td>
      <td>29</td>
      <td>93</td>
      <td>224</td>
      <td>941</td>
      <td>2641</td>
      <td>8876</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>47</th>
      <td>3</td>
      <td>0</td>
      <td>7</td>
      <td>31</td>
      <td>87</td>
      <td>263</td>
      <td>926</td>
      <td>2631</td>
      <td>8849</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>48</th>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>16</td>
      <td>112</td>
      <td>294</td>
      <td>895</td>
      <td>2626</td>
      <td>8963</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1</td>
      <td>6</td>
      <td>6</td>
      <td>28</td>
      <td>81</td>
      <td>242</td>
      <td>904</td>
      <td>2623</td>
      <td>8934</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>50</th>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>26</td>
      <td>93</td>
      <td>271</td>
      <td>979</td>
      <td>2559</td>
      <td>9070</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>51</th>
      <td>3</td>
      <td>8</td>
      <td>4</td>
      <td>24</td>
      <td>91</td>
      <td>276</td>
      <td>856</td>
      <td>2746</td>
      <td>8796</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>52</th>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>20</td>
      <td>85</td>
      <td>253</td>
      <td>944</td>
      <td>2685</td>
      <td>8824</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>53</th>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>28</td>
      <td>110</td>
      <td>281</td>
      <td>897</td>
      <td>2692</td>
      <td>9008</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>54</th>
      <td>5</td>
      <td>9</td>
      <td>10</td>
      <td>35</td>
      <td>87</td>
      <td>297</td>
      <td>789</td>
      <td>2677</td>
      <td>8916</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>55</th>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>32</td>
      <td>97</td>
      <td>322</td>
      <td>790</td>
      <td>2728</td>
      <td>8987</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>56</th>
      <td>1</td>
      <td>2</td>
      <td>7</td>
      <td>26</td>
      <td>114</td>
      <td>242</td>
      <td>919</td>
      <td>2643</td>
      <td>8970</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>57</th>
      <td>0</td>
      <td>3</td>
      <td>10</td>
      <td>18</td>
      <td>91</td>
      <td>268</td>
      <td>879</td>
      <td>2750</td>
      <td>9019</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>58</th>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>26</td>
      <td>77</td>
      <td>255</td>
      <td>895</td>
      <td>2610</td>
      <td>8923</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>59</th>
      <td>0</td>
      <td>3</td>
      <td>11</td>
      <td>25</td>
      <td>104</td>
      <td>310</td>
      <td>889</td>
      <td>2781</td>
      <td>8744</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>60</th>
      <td>1</td>
      <td>0</td>
      <td>12</td>
      <td>27</td>
      <td>80</td>
      <td>268</td>
      <td>874</td>
      <td>2739</td>
      <td>8718</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>61</th>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>24</td>
      <td>107</td>
      <td>251</td>
      <td>915</td>
      <td>2574</td>
      <td>9127</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>62</th>
      <td>0</td>
      <td>6</td>
      <td>14</td>
      <td>24</td>
      <td>78</td>
      <td>282</td>
      <td>894</td>
      <td>2713</td>
      <td>8952</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>63</th>
      <td>0</td>
      <td>4</td>
      <td>7</td>
      <td>21</td>
      <td>108</td>
      <td>287</td>
      <td>919</td>
      <td>2721</td>
      <td>9145</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>64</th>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>19</td>
      <td>100</td>
      <td>252</td>
      <td>945</td>
      <td>2758</td>
      <td>9005</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>65</th>
      <td>0</td>
      <td>0</td>
      <td>11</td>
      <td>29</td>
      <td>96</td>
      <td>271</td>
      <td>943</td>
      <td>2724</td>
      <td>9090</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>66</th>
      <td>1</td>
      <td>2</td>
      <td>11</td>
      <td>27</td>
      <td>87</td>
      <td>244</td>
      <td>940</td>
      <td>2669</td>
      <td>8847</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>67</th>
      <td>0</td>
      <td>0</td>
      <td>17</td>
      <td>26</td>
      <td>86</td>
      <td>248</td>
      <td>931</td>
      <td>2744</td>
      <td>8764</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>68</th>
      <td>0</td>
      <td>2</td>
      <td>12</td>
      <td>35</td>
      <td>85</td>
      <td>267</td>
      <td>900</td>
      <td>2749</td>
      <td>9035</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>69</th>
      <td>0</td>
      <td>6</td>
      <td>5</td>
      <td>17</td>
      <td>114</td>
      <td>279</td>
      <td>938</td>
      <td>2789</td>
      <td>9220</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>70</th>
      <td>0</td>
      <td>0</td>
      <td>16</td>
      <td>32</td>
      <td>93</td>
      <td>248</td>
      <td>854</td>
      <td>2668</td>
      <td>8880</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>71</th>
      <td>1</td>
      <td>5</td>
      <td>10</td>
      <td>13</td>
      <td>98</td>
      <td>281</td>
      <td>904</td>
      <td>2605</td>
      <td>9062</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>72</th>
      <td>0</td>
      <td>3</td>
      <td>10</td>
      <td>27</td>
      <td>91</td>
      <td>228</td>
      <td>992</td>
      <td>2782</td>
      <td>9208</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>73</th>
      <td>1</td>
      <td>2</td>
      <td>6</td>
      <td>34</td>
      <td>72</td>
      <td>279</td>
      <td>975</td>
      <td>2695</td>
      <td>8868</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>74</th>
      <td>1</td>
      <td>0</td>
      <td>10</td>
      <td>35</td>
      <td>73</td>
      <td>256</td>
      <td>880</td>
      <td>2638</td>
      <td>8853</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>75</th>
      <td>0</td>
      <td>5</td>
      <td>10</td>
      <td>30</td>
      <td>79</td>
      <td>295</td>
      <td>896</td>
      <td>2697</td>
      <td>9077</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>76</th>
      <td>2</td>
      <td>4</td>
      <td>9</td>
      <td>23</td>
      <td>97</td>
      <td>272</td>
      <td>848</td>
      <td>2708</td>
      <td>9095</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>77</th>
      <td>0</td>
      <td>1</td>
      <td>14</td>
      <td>16</td>
      <td>96</td>
      <td>283</td>
      <td>908</td>
      <td>2820</td>
      <td>9110</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>78</th>
      <td>1</td>
      <td>8</td>
      <td>14</td>
      <td>30</td>
      <td>80</td>
      <td>267</td>
      <td>968</td>
      <td>2629</td>
      <td>9100</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>79</th>
      <td>0</td>
      <td>0</td>
      <td>11</td>
      <td>23</td>
      <td>98</td>
      <td>274</td>
      <td>912</td>
      <td>2799</td>
      <td>9138</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>80</th>
      <td>1</td>
      <td>1</td>
      <td>13</td>
      <td>33</td>
      <td>112</td>
      <td>246</td>
      <td>885</td>
      <td>2718</td>
      <td>9257</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>81</th>
      <td>0</td>
      <td>5</td>
      <td>14</td>
      <td>27</td>
      <td>80</td>
      <td>261</td>
      <td>874</td>
      <td>2814</td>
      <td>8927</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>82</th>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>25</td>
      <td>79</td>
      <td>273</td>
      <td>874</td>
      <td>2765</td>
      <td>8922</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>83</th>
      <td>0</td>
      <td>4</td>
      <td>11</td>
      <td>24</td>
      <td>109</td>
      <td>284</td>
      <td>895</td>
      <td>2741</td>
      <td>9299</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>84</th>
      <td>2</td>
      <td>2</td>
      <td>7</td>
      <td>34</td>
      <td>89</td>
      <td>253</td>
      <td>866</td>
      <td>2747</td>
      <td>9046</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>85</th>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>27</td>
      <td>96</td>
      <td>248</td>
      <td>840</td>
      <td>2592</td>
      <td>9037</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>86</th>
      <td>1</td>
      <td>1</td>
      <td>7</td>
      <td>29</td>
      <td>98</td>
      <td>268</td>
      <td>818</td>
      <td>2738</td>
      <td>9106</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>87</th>
      <td>1</td>
      <td>7</td>
      <td>6</td>
      <td>25</td>
      <td>98</td>
      <td>235</td>
      <td>868</td>
      <td>2712</td>
      <td>8886</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>88</th>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>33</td>
      <td>79</td>
      <td>250</td>
      <td>931</td>
      <td>2724</td>
      <td>8930</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>89</th>
      <td>4</td>
      <td>1</td>
      <td>9</td>
      <td>22</td>
      <td>53</td>
      <td>272</td>
      <td>954</td>
      <td>2693</td>
      <td>8789</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>90</th>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>13</td>
      <td>89</td>
      <td>247</td>
      <td>921</td>
      <td>2670</td>
      <td>9032</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>91</th>
      <td>1</td>
      <td>0</td>
      <td>14</td>
      <td>16</td>
      <td>86</td>
      <td>269</td>
      <td>904</td>
      <td>2857</td>
      <td>8974</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>92</th>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>29</td>
      <td>103</td>
      <td>234</td>
      <td>878</td>
      <td>2612</td>
      <td>8936</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>93</th>
      <td>1</td>
      <td>1</td>
      <td>9</td>
      <td>26</td>
      <td>112</td>
      <td>258</td>
      <td>916</td>
      <td>2660</td>
      <td>8982</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>94</th>
      <td>1</td>
      <td>1</td>
      <td>10</td>
      <td>29</td>
      <td>76</td>
      <td>276</td>
      <td>898</td>
      <td>2745</td>
      <td>8977</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>95</th>
      <td>2</td>
      <td>2</td>
      <td>10</td>
      <td>30</td>
      <td>106</td>
      <td>259</td>
      <td>917</td>
      <td>2639</td>
      <td>8907</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>96</th>
      <td>0</td>
      <td>1</td>
      <td>9</td>
      <td>23</td>
      <td>80</td>
      <td>283</td>
      <td>856</td>
      <td>2679</td>
      <td>9135</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>97</th>
      <td>2</td>
      <td>1</td>
      <td>12</td>
      <td>17</td>
      <td>86</td>
      <td>249</td>
      <td>949</td>
      <td>2686</td>
      <td>8877</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>98</th>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>30</td>
      <td>70</td>
      <td>275</td>
      <td>858</td>
      <td>2769</td>
      <td>8956</td>
      <td>MERFISH</td>
    </tr>
    <tr>
      <th>99</th>
      <td>0</td>
      <td>10</td>
      <td>4</td>
      <td>22</td>
      <td>93</td>
      <td>251</td>
      <td>911</td>
      <td>2709</td>
      <td>8903</td>
      <td>MERFISH</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="x-scrna-seq-data">
<h5>10x scRNA-seq data:<a class="headerlink" href="#x-scrna-seq-data" title="Permalink to this headline">#</a></h5>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tenx_original_synth</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gene 1</th>
      <th>Gene 2</th>
      <th>Gene 3</th>
      <th>Gene 4</th>
      <th>Gene 5</th>
      <th>Gene 6</th>
      <th>Gene 7</th>
      <th>Gene 8</th>
      <th>Gene 9</th>
      <th>Model</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>11</td>
      <td>52</td>
      <td>89</td>
      <td>286</td>
      <td>842</td>
      <td>2944</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>42</td>
      <td>89</td>
      <td>301</td>
      <td>887</td>
      <td>3110</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>8</td>
      <td>38</td>
      <td>105</td>
      <td>299</td>
      <td>936</td>
      <td>2967</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>49</td>
      <td>89</td>
      <td>290</td>
      <td>884</td>
      <td>2942</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>15</td>
      <td>27</td>
      <td>77</td>
      <td>298</td>
      <td>901</td>
      <td>3065</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>11</td>
      <td>30</td>
      <td>91</td>
      <td>290</td>
      <td>897</td>
      <td>3065</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>15</td>
      <td>26</td>
      <td>95</td>
      <td>330</td>
      <td>959</td>
      <td>3050</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>9</td>
      <td>28</td>
      <td>84</td>
      <td>295</td>
      <td>896</td>
      <td>2993</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>10</td>
      <td>29</td>
      <td>101</td>
      <td>305</td>
      <td>933</td>
      <td>2980</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>8</td>
      <td>31</td>
      <td>101</td>
      <td>323</td>
      <td>862</td>
      <td>2992</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>8</td>
      <td>22</td>
      <td>98</td>
      <td>270</td>
      <td>885</td>
      <td>2990</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>14</td>
      <td>38</td>
      <td>100</td>
      <td>282</td>
      <td>920</td>
      <td>2971</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>6</td>
      <td>28</td>
      <td>82</td>
      <td>331</td>
      <td>915</td>
      <td>2990</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>16</td>
      <td>27</td>
      <td>86</td>
      <td>301</td>
      <td>888</td>
      <td>3098</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1</td>
      <td>0</td>
      <td>6</td>
      <td>10</td>
      <td>44</td>
      <td>84</td>
      <td>334</td>
      <td>908</td>
      <td>3062</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>7</td>
      <td>33</td>
      <td>95</td>
      <td>310</td>
      <td>958</td>
      <td>3057</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>8</td>
      <td>29</td>
      <td>85</td>
      <td>310</td>
      <td>900</td>
      <td>3068</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>11</td>
      <td>26</td>
      <td>102</td>
      <td>299</td>
      <td>914</td>
      <td>2956</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>11</td>
      <td>37</td>
      <td>93</td>
      <td>306</td>
      <td>893</td>
      <td>2924</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>9</td>
      <td>35</td>
      <td>101</td>
      <td>289</td>
      <td>953</td>
      <td>2967</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>6</td>
      <td>26</td>
      <td>91</td>
      <td>294</td>
      <td>946</td>
      <td>2973</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>10</td>
      <td>27</td>
      <td>92</td>
      <td>306</td>
      <td>906</td>
      <td>3029</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>11</td>
      <td>28</td>
      <td>100</td>
      <td>302</td>
      <td>902</td>
      <td>3022</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>30</td>
      <td>89</td>
      <td>275</td>
      <td>935</td>
      <td>3018</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>29</td>
      <td>85</td>
      <td>307</td>
      <td>861</td>
      <td>3013</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>29</td>
      <td>108</td>
      <td>278</td>
      <td>905</td>
      <td>3048</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>10</td>
      <td>31</td>
      <td>96</td>
      <td>335</td>
      <td>910</td>
      <td>2984</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>5</td>
      <td>32</td>
      <td>117</td>
      <td>269</td>
      <td>890</td>
      <td>2991</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>9</td>
      <td>30</td>
      <td>85</td>
      <td>298</td>
      <td>858</td>
      <td>2980</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>30</td>
      <td>67</td>
      <td>291</td>
      <td>910</td>
      <td>3087</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>11</td>
      <td>27</td>
      <td>89</td>
      <td>333</td>
      <td>925</td>
      <td>2963</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>30</td>
      <td>93</td>
      <td>296</td>
      <td>892</td>
      <td>3070</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>10</td>
      <td>30</td>
      <td>87</td>
      <td>286</td>
      <td>947</td>
      <td>3064</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>45</td>
      <td>96</td>
      <td>276</td>
      <td>907</td>
      <td>2971</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>34</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>6</td>
      <td>19</td>
      <td>73</td>
      <td>304</td>
      <td>943</td>
      <td>3078</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>35</th>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>7</td>
      <td>38</td>
      <td>82</td>
      <td>278</td>
      <td>850</td>
      <td>3129</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>36</th>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>9</td>
      <td>29</td>
      <td>78</td>
      <td>269</td>
      <td>900</td>
      <td>2958</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>9</td>
      <td>30</td>
      <td>92</td>
      <td>288</td>
      <td>839</td>
      <td>2942</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>38</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>28</td>
      <td>85</td>
      <td>317</td>
      <td>882</td>
      <td>2980</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>11</td>
      <td>29</td>
      <td>75</td>
      <td>345</td>
      <td>931</td>
      <td>2878</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>40</th>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>39</td>
      <td>64</td>
      <td>300</td>
      <td>889</td>
      <td>2874</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>41</th>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>6</td>
      <td>36</td>
      <td>83</td>
      <td>296</td>
      <td>858</td>
      <td>3036</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>28</td>
      <td>84</td>
      <td>286</td>
      <td>918</td>
      <td>3024</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>43</th>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>13</td>
      <td>26</td>
      <td>97</td>
      <td>285</td>
      <td>885</td>
      <td>3032</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>44</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>10</td>
      <td>36</td>
      <td>79</td>
      <td>321</td>
      <td>921</td>
      <td>2973</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>45</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>35</td>
      <td>102</td>
      <td>282</td>
      <td>868</td>
      <td>2925</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>46</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>9</td>
      <td>26</td>
      <td>74</td>
      <td>315</td>
      <td>875</td>
      <td>2895</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>47</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>9</td>
      <td>27</td>
      <td>86</td>
      <td>311</td>
      <td>820</td>
      <td>2869</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>48</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>40</td>
      <td>97</td>
      <td>292</td>
      <td>862</td>
      <td>2926</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>49</th>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>10</td>
      <td>34</td>
      <td>85</td>
      <td>278</td>
      <td>897</td>
      <td>3000</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>50</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>9</td>
      <td>34</td>
      <td>89</td>
      <td>332</td>
      <td>850</td>
      <td>3064</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>51</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>7</td>
      <td>35</td>
      <td>92</td>
      <td>293</td>
      <td>913</td>
      <td>2947</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>52</th>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>8</td>
      <td>23</td>
      <td>80</td>
      <td>326</td>
      <td>855</td>
      <td>2990</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>53</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>37</td>
      <td>96</td>
      <td>311</td>
      <td>915</td>
      <td>2984</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>54</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>11</td>
      <td>28</td>
      <td>104</td>
      <td>285</td>
      <td>881</td>
      <td>2928</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>55</th>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>13</td>
      <td>26</td>
      <td>121</td>
      <td>261</td>
      <td>925</td>
      <td>2961</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>56</th>
      <td>0</td>
      <td>1</td>
      <td>7</td>
      <td>5</td>
      <td>45</td>
      <td>71</td>
      <td>298</td>
      <td>900</td>
      <td>2975</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>57</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>30</td>
      <td>79</td>
      <td>292</td>
      <td>902</td>
      <td>2983</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>58</th>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>6</td>
      <td>26</td>
      <td>85</td>
      <td>288</td>
      <td>829</td>
      <td>2999</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>59</th>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>7</td>
      <td>33</td>
      <td>97</td>
      <td>318</td>
      <td>908</td>
      <td>2856</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>60</th>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>7</td>
      <td>37</td>
      <td>107</td>
      <td>286</td>
      <td>930</td>
      <td>2832</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>61</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>6</td>
      <td>35</td>
      <td>75</td>
      <td>321</td>
      <td>842</td>
      <td>3054</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>62</th>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>4</td>
      <td>29</td>
      <td>93</td>
      <td>277</td>
      <td>928</td>
      <td>2985</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>63</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>6</td>
      <td>35</td>
      <td>91</td>
      <td>307</td>
      <td>895</td>
      <td>3041</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>64</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>36</td>
      <td>78</td>
      <td>327</td>
      <td>920</td>
      <td>2991</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>65</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>28</td>
      <td>87</td>
      <td>323</td>
      <td>894</td>
      <td>2968</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>66</th>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>35</td>
      <td>66</td>
      <td>322</td>
      <td>905</td>
      <td>2982</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>67</th>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>11</td>
      <td>36</td>
      <td>77</td>
      <td>320</td>
      <td>914</td>
      <td>2900</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>68</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>20</td>
      <td>25</td>
      <td>101</td>
      <td>298</td>
      <td>882</td>
      <td>3019</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>69</th>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>11</td>
      <td>36</td>
      <td>97</td>
      <td>314</td>
      <td>930</td>
      <td>3111</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>70</th>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>14</td>
      <td>36</td>
      <td>87</td>
      <td>276</td>
      <td>890</td>
      <td>2953</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>71</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>6</td>
      <td>30</td>
      <td>91</td>
      <td>308</td>
      <td>844</td>
      <td>3035</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>72</th>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>11</td>
      <td>32</td>
      <td>83</td>
      <td>327</td>
      <td>898</td>
      <td>3072</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>73</th>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>11</td>
      <td>27</td>
      <td>81</td>
      <td>323</td>
      <td>875</td>
      <td>3061</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>74</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>14</td>
      <td>32</td>
      <td>83</td>
      <td>284</td>
      <td>846</td>
      <td>3013</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>75</th>
      <td>0</td>
      <td>4</td>
      <td>7</td>
      <td>10</td>
      <td>30</td>
      <td>101</td>
      <td>303</td>
      <td>876</td>
      <td>2961</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>76</th>
      <td>2</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
      <td>30</td>
      <td>87</td>
      <td>281</td>
      <td>938</td>
      <td>3044</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>77</th>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>6</td>
      <td>31</td>
      <td>95</td>
      <td>328</td>
      <td>940</td>
      <td>3018</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>78</th>
      <td>0</td>
      <td>6</td>
      <td>4</td>
      <td>9</td>
      <td>27</td>
      <td>103</td>
      <td>329</td>
      <td>897</td>
      <td>2969</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>79</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>32</td>
      <td>88</td>
      <td>312</td>
      <td>994</td>
      <td>3083</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>80</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>8</td>
      <td>31</td>
      <td>93</td>
      <td>294</td>
      <td>910</td>
      <td>3066</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>81</th>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>9</td>
      <td>39</td>
      <td>96</td>
      <td>291</td>
      <td>957</td>
      <td>3006</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>82</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>24</td>
      <td>85</td>
      <td>297</td>
      <td>896</td>
      <td>2925</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>83</th>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>11</td>
      <td>39</td>
      <td>89</td>
      <td>307</td>
      <td>914</td>
      <td>3194</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>84</th>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>10</td>
      <td>30</td>
      <td>83</td>
      <td>286</td>
      <td>854</td>
      <td>2958</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>85</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>13</td>
      <td>36</td>
      <td>89</td>
      <td>281</td>
      <td>879</td>
      <td>3004</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>86</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>10</td>
      <td>39</td>
      <td>95</td>
      <td>290</td>
      <td>922</td>
      <td>3033</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>87</th>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>7</td>
      <td>33</td>
      <td>80</td>
      <td>324</td>
      <td>884</td>
      <td>2980</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>88</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>10</td>
      <td>29</td>
      <td>85</td>
      <td>300</td>
      <td>944</td>
      <td>2966</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>89</th>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>5</td>
      <td>18</td>
      <td>101</td>
      <td>321</td>
      <td>911</td>
      <td>2864</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>90</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>29</td>
      <td>88</td>
      <td>293</td>
      <td>860</td>
      <td>3024</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>91</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>7</td>
      <td>30</td>
      <td>87</td>
      <td>301</td>
      <td>975</td>
      <td>2996</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>92</th>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>9</td>
      <td>26</td>
      <td>85</td>
      <td>280</td>
      <td>881</td>
      <td>3051</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>93</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10</td>
      <td>43</td>
      <td>95</td>
      <td>299</td>
      <td>923</td>
      <td>2970</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>94</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>15</td>
      <td>29</td>
      <td>110</td>
      <td>300</td>
      <td>842</td>
      <td>3013</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>95</th>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>11</td>
      <td>35</td>
      <td>84</td>
      <td>327</td>
      <td>888</td>
      <td>2998</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>96</th>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>7</td>
      <td>19</td>
      <td>86</td>
      <td>276</td>
      <td>930</td>
      <td>3097</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>97</th>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>6</td>
      <td>27</td>
      <td>113</td>
      <td>320</td>
      <td>872</td>
      <td>2887</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>98</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>7</td>
      <td>28</td>
      <td>77</td>
      <td>299</td>
      <td>923</td>
      <td>3048</td>
      <td>10x scRNA-seq</td>
    </tr>
    <tr>
      <th>99</th>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>31</td>
      <td>94</td>
      <td>310</td>
      <td>935</td>
      <td>2918</td>
      <td>10x scRNA-seq</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="plotting-data">
<h4>Plotting data:<a class="headerlink" href="#plotting-data" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">before_imputation</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">synth_cells</span><span class="p">,</span> <span class="n">merfish_original_synth</span><span class="p">,</span> <span class="n">tenx_original_synth</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">genes</span> <span class="o">=</span> <span class="n">before_imputation</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">genes</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">before_imputation</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.3</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/notebooks_18_0.png" src="_images/notebooks_18_0.png" />
<img alt="_images/notebooks_18_1.png" src="_images/notebooks_18_1.png" />
<img alt="_images/notebooks_18_2.png" src="_images/notebooks_18_2.png" />
<img alt="_images/notebooks_18_3.png" src="_images/notebooks_18_3.png" />
<img alt="_images/notebooks_18_4.png" src="_images/notebooks_18_4.png" />
<img alt="_images/notebooks_18_5.png" src="_images/notebooks_18_5.png" />
<img alt="_images/notebooks_18_6.png" src="_images/notebooks_18_6.png" />
<img alt="_images/notebooks_18_7.png" src="_images/notebooks_18_7.png" />
<img alt="_images/notebooks_18_8.png" src="_images/notebooks_18_8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">before_imputation</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">genes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span><span class="n">genes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/notebooks_19_0.png" src="_images/notebooks_19_0.png" />
<img alt="_images/notebooks_19_1.png" src="_images/notebooks_19_1.png" />
<img alt="_images/notebooks_19_2.png" src="_images/notebooks_19_2.png" />
<img alt="_images/notebooks_19_3.png" src="_images/notebooks_19_3.png" />
<img alt="_images/notebooks_19_4.png" src="_images/notebooks_19_4.png" />
</div>
</div>
<p>From the plots, we can see that the MERFISH distributions more closely resemble that of the Ground Truth dataset. Thus, our goal with imputation is to transform the 10x scRNA-seq data to become more similar to the MERFISH data.</p>
</section>
</section>
</section>
<section id="imputation">
<h2>2. Imputation<a class="headerlink" href="#imputation" title="Permalink to this headline">#</a></h2>
<section id="normalization">
<h3>2.1: Normalization<a class="headerlink" href="#normalization" title="Permalink to this headline">#</a></h3>
<p>Normalizing the RNA counts as a processing step for MAGIC. Using the MERFISH as basis for normalized sum to compare downstream. Before MAGIC, the 10x scRNA-seq data is normalized by the median RNA count of the dataset, then the values are square rooted.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merfish_original_synth</span> <span class="o">=</span> <span class="n">merfish_original_synth</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">])</span>
<span class="n">tenx_original_synth</span> <span class="o">=</span> <span class="n">tenx_original_synth</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">])</span>

<span class="c1"># obtaining target sum for normalization</span>
<span class="n">merfish_rna_counts</span> <span class="o">=</span> <span class="n">merfish_original_synth</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">normalized_sum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">merfish_rna_counts</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

<span class="c1"># Normalizing dataset</span>
<span class="n">merfish_repr</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">AnnData</span><span class="p">(</span><span class="n">merfish_original_synth</span><span class="p">)</span>
<span class="n">tenx_repr</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">AnnData</span><span class="p">(</span><span class="n">tenx_original_synth</span><span class="p">)</span>

<span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">normalize_total</span><span class="p">(</span><span class="n">merfish_repr</span><span class="p">,</span> <span class="n">target_sum</span><span class="o">=</span><span class="n">normalized_sum</span><span class="p">)</span>
<span class="n">tenx_norm</span> <span class="o">=</span> <span class="n">tenx_repr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">normalize_total</span><span class="p">(</span><span class="n">tenx_norm</span><span class="p">,</span> <span class="n">target_sum</span><span class="o">=</span><span class="n">normalized_sum</span><span class="p">)</span>

<span class="c1"># Pre-processing step for MAGIC</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">normalize_total</span><span class="p">(</span><span class="n">tenx_repr</span><span class="p">)</span>
<span class="n">tenx_raw</span> <span class="o">=</span> <span class="n">tenx_repr</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span> <span class="c1"># use later for rescaling</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">tenx_repr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_1963/1306700857.py:9: FutureWarning: X.dtype being converted to np.float32 from int64. In the next version of anndata (0.9) conversion will not be automatic. Pass dtype explicitly to avoid this warning. Pass `AnnData(X, dtype=X.dtype, ...)` to get the future behavour.
  merfish_repr = sc.AnnData(merfish_original_synth)
/opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/anndata/_core/anndata.py:121: ImplicitModificationWarning: Transforming to str index.
  warnings.warn(&quot;Transforming to str index.&quot;, ImplicitModificationWarning)
/tmp/ipykernel_1963/1306700857.py:10: FutureWarning: X.dtype being converted to np.float32 from int64. In the next version of anndata (0.9) conversion will not be automatic. Pass dtype explicitly to avoid this warning. Pass `AnnData(X, dtype=X.dtype, ...)` to get the future behavour.
  tenx_repr = sc.AnnData(tenx_original_synth)
</pre></div>
</div>
</div>
</div>
</section>
<section id="running-magic">
<h3>2.2: Running MAGIC<a class="headerlink" href="#running-magic" title="Permalink to this headline">#</a></h3>
<p>Running MAGIC with default parameters and normalizing the imputed counts back to the basis of the MERFISH median by squaring and normalizing sum.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sce</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">magic</span><span class="p">(</span><span class="n">tenx_repr</span><span class="p">,</span> <span class="n">name_list</span><span class="o">=</span><span class="s1">&#39;all_genes&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">tenx_repr</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">tenx_repr</span><span class="o">.</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.8.15/x64/lib/python3.8/site-packages/magic/utils.py:145: FutureWarning: X.dtype being converted to np.float32 from float64. In the next version of anndata (0.9) conversion will not be automatic. Pass dtype explicitly to avoid this warning. Pass `AnnData(X, dtype=X.dtype, ...)` to get the future behavour.
  data = anndata.AnnData(data)
</pre></div>
</div>
</div>
</div>
</section>
<section id="rescaling-imputed-counts">
<h3>2.3: Rescaling Imputed Counts<a class="headerlink" href="#rescaling-imputed-counts" title="Permalink to this headline">#</a></h3>
<p>Duplicating the results of MAGIC to determine whether rescaling after imputation is still necessary. Using a vestigial function <code class="docutils literal notranslate"><span class="pre">rescale_data()</span></code> from the <a class="reference external" href="https://github.com/KrishnaswamyLab">Krishnaswamy Lab</a>.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tenx_rescaled_norm</span> <span class="o">=</span> <span class="n">tenx_repr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">imputed_rescaled_df</span> <span class="o">=</span> <span class="n">tenx_rescaled_norm</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
<span class="n">imputed_rescaled_df</span> <span class="o">=</span> <span class="n">rescale_data</span><span class="p">(</span><span class="n">imputed_rescaled_df</span><span class="p">,</span> <span class="n">tenx_raw</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
<span class="n">imputed_rescaled</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">AnnData</span><span class="p">(</span><span class="n">imputed_rescaled_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_1963/2028333819.py:4: FutureWarning: X.dtype being converted to np.float32 from float64. In the next version of anndata (0.9) conversion will not be automatic. Pass dtype explicitly to avoid this warning. Pass `AnnData(X, dtype=X.dtype, ...)` to get the future behavour.
  imputed_rescaled = sc.AnnData(imputed_rescaled_df)
</pre></div>
</div>
</div>
</div>
<p>Here, we are re-normalizing the both the impute counts with and without rescaling to the previously used target sum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">normalize_total</span><span class="p">(</span><span class="n">tenx_repr</span><span class="p">,</span> <span class="n">target_sum</span><span class="o">=</span><span class="n">normalized_sum</span><span class="p">)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">normalize_total</span><span class="p">(</span><span class="n">imputed_rescaled</span><span class="p">,</span> <span class="n">target_sum</span><span class="o">=</span><span class="n">normalized_sum</span><span class="p">)</span>

<span class="n">imputed_df</span> <span class="o">=</span> <span class="n">tenx_repr</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
<span class="n">imputed_rescaled_df</span> <span class="o">=</span> <span class="n">imputed_rescaled</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
<span class="n">merfish_df</span> <span class="o">=</span> <span class="n">merfish_repr</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
<span class="n">tenx_norm_df</span> <span class="o">=</span> <span class="n">tenx_norm</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>

<span class="n">imputed_df</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;10x scRNA-seq Imputed&quot;</span>
<span class="n">imputed_rescaled_df</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;10x Imputed Rescaled&quot;</span>
<span class="n">tenx_norm_df</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;10x scRNA-seq&quot;</span>
<span class="n">merfish_df</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MERFISH Normalized&quot;</span>
<span class="n">synth_cells</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;True cells&quot;</span>

<span class="n">after_imputation</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">imputed_rescaled_df</span><span class="p">,</span><span class="n">merfish_df</span><span class="p">,</span> <span class="n">tenx_norm_df</span><span class="p">,</span> <span class="n">synth_cells</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="results-after-imputation">
<h2>3. Results after Imputation<a class="headerlink" href="#results-after-imputation" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">after_imputation</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">genes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span><span class="n">genes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/notebooks_31_0.png" src="_images/notebooks_31_0.png" />
<img alt="_images/notebooks_31_1.png" src="_images/notebooks_31_1.png" />
<img alt="_images/notebooks_31_2.png" src="_images/notebooks_31_2.png" />
<img alt="_images/notebooks_31_3.png" src="_images/notebooks_31_3.png" />
<img alt="_images/notebooks_31_4.png" src="_images/notebooks_31_4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">after_imputation</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">genes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span><span class="n">genes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/notebooks_32_0.png" src="_images/notebooks_32_0.png" />
<img alt="_images/notebooks_32_1.png" src="_images/notebooks_32_1.png" />
<img alt="_images/notebooks_32_2.png" src="_images/notebooks_32_2.png" />
<img alt="_images/notebooks_32_3.png" src="_images/notebooks_32_3.png" />
<img alt="_images/notebooks_32_4.png" src="_images/notebooks_32_4.png" />
</div>
</div>
<p>Thinking of including a metric to evaluate the performance of imputation. I could also write another blog post about the metric.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="markdown.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Markdown Files</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Saul Vega Sauceda<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>